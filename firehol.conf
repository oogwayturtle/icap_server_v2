#
# FireHOL configuration (autogenerated)
#
# This config will have the same effect as NO PROTECTION!
# Everything that found to be running, is allowed.
# YOU SHOULD NEVER USE THIS CONFIG AS-IS.
# 
# Date: Tue Mar  3 17:44:16 EST 2020 on host wifirouter
# 
# IMPORTANT:
# The TODOs bellow, are *YOUR* to-dos!
#

# INFO: Processing interface 'br-02c455c3f376'
# INFO: Processing IP 172.20.0.1 of interface 'br-02c455c3f376'
# INFO: Is 172.20.0.1 part of network 172.20.0.0/16? yes

# Interface No 1.
# The purpose of this interface is to control the traffic
# on the br-02c455c3f376 interface with IP 172.20.0.1 (net: "172.20.0.0/16 ").
# TODO: Change "if1" to something with meaning to you.
# TODO: Check the optional rule parameters (src/dst).
#       Remove 'dst 172.20.0.1' if this is dynamically assigned.
#       To add IPv6, read http://firehol.org/upgrade/#config-version-6
# INFO: Processing interface 'squid_interface'
# INFO: Processing IP 172.23.0.1 of interface 'squid_interface'
# INFO: Is 172.23.0.1 part of network 172.23.0.0/16? yes

# Interface No 2.
# The purpose of this interface is to control the traffic
# on the squid_interface interface with IP 172.23.0.1 (net: "172.23.0.0/16  ").
# TODO: Change "if2" to something with meaning to you.
# TODO: Check the optional rule parameters (src/dst).
#       Remove 'dst 172.23.0.1' if this is dynamically assigned.
#       To add IPv6, read http://firehol.org/upgrade/#config-version-6
redirect4 to 3129 inface enp2s0 src 192.168.2.0/24 proto tcp dport 80 
redirect4 to 3129 inface enp2s0 src 192.168.2.0/24 proto tcp dport 8080
redirect4 to 3130 inface enp2s0 src 192.168.2.0/24 proto tcp dport 443

interface4 squid_interface if2 src "172.23.0.0/16  " dst 172.23.0.1

	# The default policy is DROP. You can be more polite with REJECT.
	# Prefer to be polite on your own clients to prevent timeouts.
	policy accept

	# If you don't trust the clients behind squid_interface (net "172.23.0.0/16  "),
	# add something like this.
	# > protection strong

	# Here are the services listening on squid_interface.
	# TODO: Normally, you will have to remove those not needed.
	server ICMP accept
	server squid accept

	# The following squid_interface services are not known by FireHOL:
	# tcp/3129 tcp/3130 

	# Custom service definitions for the above unknown services.
	server custom if2_1 tcp/3129 any accept
	server custom if2_2 tcp/3130 any accept

	# The following means that this machine can REQUEST anything via squid_interface.
	# TODO: On production servers, avoid this and allow only the
	#       client services you really need.
	client all accept

# INFO: Processing interface 'enp2s0'
# INFO: Processing IP 192.168.2.185 of interface 'enp2s0'
# INFO: Is 192.168.2.185 part of network 192.168.2.0/24? yes

# Interface No 3.
# The purpose of this interface is to control the traffic
# on the enp2s0 interface with IP 192.168.2.185 (net: "192.168.2.0/24   ").
# TODO: Change "if3" to something with meaning to you.
# TODO: Check the optional rule parameters (src/dst).
#       Remove 'dst 192.168.2.185' if this is dynamically assigned.
#       To add IPv6, read http://firehol.org/upgrade/#config-version-6
interface4 enp2s0 if3 src "192.168.2.0/24" dst 192.168.2.185

	# The default policy is DROP. You can be more polite with REJECT.
	# Prefer to be polite on your own clients to prevent timeouts.
	policy accept

	# If you don't trust the clients behind enp2s0 (net "192.168.2.0/24   "),
	# add something like this.
	# > protection strong

	# Here are the services listening on enp2s0.
	# TODO: Normally, you will have to remove those not needed.
	server ICMP accept
	server squid accept

	# The following enp2s0 services are not known by FireHOL:
	# tcp/3129 tcp/3130 

	# Custom service definitions for the above unknown services.
	server custom if3_1 tcp/3129 any accept
	server custom if3_2 tcp/3130 any accept
	server dns accept
	# The following means that this machine can REQUEST anything via enp2s0.
	# TODO: On production servers, avoid this and allow only the
	#       client services you really need.
	client all accept

# INFO: Is 192.168.2.1  part of network 192.168.2.0/24? yes
# INFO: Default gateway 192.168.2.1  is part of network 192.168.2.0/24

# Interface No 4.
# The purpose of this interface is to control the traffic
# from/to unknown networks behind the default gateway 192.168.2.1 .
# TODO: Change "if4" to something with meaning to you.
# TODO: Check the optional rule parameters (src/dst).
#       Remove 'dst 192.168.2.185' if this is dynamically assigned.
#       To add IPv6, read http://firehol.org/upgrade/#config-version-6
interface4 enp2s0 if4 src not "${UNROUTABLE_IPS}" dst 192.168.2.1

	# The default policy is DROP. You can be more polite with REJECT.
	# Prefer to be polite on your own clients to prevent timeouts.
	policy accept
	# If you don't trust the clients behind enp2s0 (net not "${UNROUTABLE_IPS} 192.168.2.0/24   "),
	# add something like this.
	# > protection strong

	# Here are the services listening on enp2s0.
	# TODO: Normally, you will have to remove those not needed.
	server ICMP accept
	server squid accept
	server dns  accept
	# The following enp2s0 services are not known by FireHOL:
	# tcp/3129 tcp/3130 

	# Custom service definitions for the above unknown services.
	server custom if4_1 tcp/3129 any accept
	server custom if4_2 tcp/3130 any accept

	# The following means that this machine can REQUEST anything via enp2s0.
	# TODO: On production servers, avoid this and allow only the
	#       client services you really need.
	client all accept

# INFO: Processing interface 'vethef1d0c2'

# IMPORTANT: 
# Ignoring interface 'vethef1d0c2' because does not have an IP or route.

# INFO: Processing interface 'wlp1s0'
# INFO: Processing IP 192.168.0.1 of interface 'wlp1s0'
# INFO: Is 192.168.0.1 part of network 192.168.0.0/24? yes

# Interface No 5.
# The purpose of this interface is to control the traffic
# on the wlp1s0 interface with IP 192.168.0.1 (net: "192.168.0.0/24    ").
# TODO: Change "if5" to something with meaning to you.
# TODO: Check the optional rule parameters (src/dst).
#       Remove 'dst 192.168.0.1' if this is dynamically assigned.
#       To add IPv6, read http://firehol.org/upgrade/#config-version-6
interface4 wlp1s0 if5 src "192.168.0.0/24    " dst 192.168.0.1

	# The default policy is DROP. You can be more polite with REJECT.
	# Prefer to be polite on your own clients to prevent timeouts.
	policy drop

	# If you don't trust the clients behind wlp1s0 (net "192.168.0.0/24    "),
	# add something like this.
	# > protection strong

	# Here are the services listening on wlp1s0.
	# TODO: Normally, you will have to remove those not needed.
	server ICMP accept
	server squid accept

	# The following wlp1s0 services are not known by FireHOL:
	# tcp/3129 tcp/3130 

	# Custom service definitions for the above unknown services.
	server custom if5_1 tcp/3129 any accept
	server custom if5_2 tcp/3130 any accept

	# The following means that this machine can REQUEST anything via wlp1s0.
	# TODO: On production servers, avoid this and allow only the
	#       client services you really need.
	client all accept


# The above 5 interfaces were found active at this moment.
# Add more interfaces that can potentially be activated in the future.
# FireHOL will not complain if you setup a firewall on an interface that is
# not active when you activate the firewall.
# If you don't setup an interface, FireHOL will drop all traffic from or to
# this interface, if and when it becomes available.
# Also, if an interface name dynamically changes (i.e. ppp0 may become ppp1)
# you can use the plus (+) character to match all of them (i.e. ppp+).


# Router No 1.
# Clients on br-02c455c3f376 (from "172.20.0.0/16 ") accessing servers on squid_interface (to "172.23.0.0/16  ").
# TODO: Change "router01" to something with meaning to you.
# TODO: Check the optional rule parameters (src/dst).
#       To add IPv6, read http://firehol.org/upgrade/#config-version-6
# Router No 2.
# Clients on br-02c455c3f376 (from "172.20.0.0/16 ") accessing servers on enp2s0 (to "192.168.2.0/24   ").
# TODO: Change "router02" to something with meaning to you.
# TODO: Check the optional rule parameters (src/dst).
#       To add IPv6, read http://firehol.org/upgrade/#config-version-6
router4 router06 inface squid_interface outface enp2s0 src "172.23.0.0/16  " dst "192.168.2.0/24   "

	# If you don't trust the clients on squid_interface (from "172.23.0.0/16  "), or
	# if you want to protect the servers on enp2s0 (to "192.168.2.0/24   "),
	# uncomment the following line.
	# > protection strong

	# To NAT client requests on the output of enp2s0, add this.
	# > masquerade
	# Alternatively, you can SNAT them by placing this at the top of this config:
	# > snat to 192.168.2.185 outface enp2s0 src "172.23.0.0/16  " dst "192.168.2.0/24   "
	# SNAT commands can be enhanced using 'proto', 'sport', 'dport', etc in order to
	# NAT only some specific traffic.

	# TODO: This will allow all traffic to pass.
	# If you remove it, no REQUEST will pass matching this traffic.
        client all accept
	route all accept


# Router No 7.
# Clients on squid_interface (from "172.23.0.0/16  ") accessing servers on enp2s0 (to not "${UNROUTABLE_IPS} 192.168.2.0/24   ").
# TODO: Change "router07" to something with meaning to you.
# TODO: Check the optional rule parameters (src/dst).
#       To add IPv6, read http://firehol.org/upgrade/#config-version-6
router4 router07 inface squid_interface outface enp2s0 src "172.23.0.0/16  " dst not "${UNROUTABLE_IPS} 192.168.2.0/24   "

	# If you don't trust the clients on squid_interface (from "172.23.0.0/16  "), or
	# if you want to protect the servers on enp2s0 (to not "${UNROUTABLE_IPS} 192.168.2.0/24   "),
	# uncomment the following line.
	# > protection strong

	# To NAT client requests on the output of enp2s0, add this.
	# > masquerade
	# Alternatively, you can SNAT them by placing this at the top of this config:
	# > snat to 192.168.2.185 outface enp2s0 src "172.23.0.0/16  " dst not "${UNROUTABLE_IPS} 192.168.2.0/24   "
	# SNAT commands can be enhanced using 'proto', 'sport', 'dport', etc in order to
	# NAT only some specific traffic.

	# TODO: This will allow all traffic to pass.
	# If you remove it, no REQUEST will pass matching this traffic.
        client all accept
	route all accept


# Router No 8.
# Clients on squid_interface (from "172.23.0.0/16  ") accessing servers on wlp1s0 (to "192.168.0.0/24    ").
# TODO: Change "router08" to something with meaning to you.
# TODO: Check the optional rule parameters (src/dst).
#       To add IPv6, read http://firehol.org/upgrade/#config-version-6
router4 router08 inface squid_interface outface wlp1s0 src "172.23.0.0/16  " dst "192.168.0.0/24    "

	# If you don't trust the clients on squid_interface (from "172.23.0.0/16  "), or
	# if you want to protect the servers on wlp1s0 (to "192.168.0.0/24    "),
	# uncomment the following line.
	# > protection strong

	# To NAT client requests on the output of wlp1s0, add this.
	# > masquerade
	# Alternatively, you can SNAT them by placing this at the top of this config:
	# > snat to 192.168.0.1 outface wlp1s0 src "172.23.0.0/16  " dst "192.168.0.0/24    "
	# SNAT commands can be enhanced using 'proto', 'sport', 'dport', etc in order to
	# NAT only some specific traffic.

	# TODO: This will allow all traffic to pass.
	# If you remove it, no REQUEST will pass matching this traffic.
	route all accept


# Router No 10.
# Clients on enp2s0 (from "192.168.2.0/24   ") accessing servers on squid_interface (to "172.23.0.0/16  ").
# TODO: Change "router10" to something with meaning to you.
# TODO: Check the optional rule parameters (src/dst).
#       To add IPv6, read http://firehol.org/upgrade/#config-version-6
router4 router10 inface enp2s0 outface squid_interface src "192.168.2.0/24   " dst "172.23.0.0/16  "

	# If you don't trust the clients on enp2s0 (from "192.168.2.0/24   "), or
	# if you want to protect the servers on squid_interface (to "172.23.0.0/16  "),
	# uncomment the following line.
	# > protection strong

	# To NAT client requests on the output of squid_interface, add this.
	# > masquerade
	# Alternatively, you can SNAT them by placing this at the top of this config:
	# > snat to 172.23.0.1 outface squid_interface src "192.168.2.0/24   " dst "172.23.0.0/16  "
	# SNAT commands can be enhanced using 'proto', 'sport', 'dport', etc in order to
	# NAT only some specific traffic.

	# TODO: This will allow all traffic to pass.
	# If you remove it, no REQUEST will pass matching this traffic.
        client all accept
	route all accept


# Router No 11.
# Clients on enp2s0 (from "192.168.2.0/24   ") accessing servers on enp2s0 (to not "${UNROUTABLE_IPS} 192.168.2.0/24   ").
# TODO: Change "router11" to something with meaning to you.
# TODO: Check the optional rule parameters (src/dst).
#       To add IPv6, read http://firehol.org/upgrade/#config-version-6
router4 router11 inface enp2s0 outface enp2s0 src "192.168.2.0/24   " dst not "${UNROUTABLE_IPS}"

	# If you don't trust the clients on enp2s0 (from "192.168.2.0/24   "), or
	# if you want to protect the servers on enp2s0 (to not "${UNROUTABLE_IPS} 192.168.2.0/24   "),
	# uncomment the following line.
	# > protection strong

	# To NAT client requests on the output of enp2s0, add this.
	# > masquerade
	# Alternatively, you can SNAT them by placing this at the top of this config:
	# > snat to 192.168.2.185 outface enp2s0 src "192.168.2.0/24   " dst not "${UNROUTABLE_IPS} 192.168.2.0/24   "
	# SNAT commands can be enhanced using 'proto', 'sport', 'dport', etc in order to
	# NAT only some specific traffic.

	# TODO: This will allow all traffic to pass.
	# If you remove it, no REQUEST will pass matching this traffic.
        server all accept
        client all accept
	route all accept


# Router No 12.
# Clients on enp2s0 (from "192.168.2.0/24   ") accessing servers on wlp1s0 (to "192.168.0.0/24    ").
# TODO: Change "router12" to something with meaning to you.
# TODO: Check the optional rule parameters (src/dst).
#       To add IPv6, read http://firehol.org/upgrade/#config-version-6
router4 router12 inface enp2s0 outface wlp1s0 src "192.168.2.0/24   " dst "192.168.0.0/24    "

	# If you don't trust the clients on enp2s0 (from "192.168.2.0/24   "), or
	# if you want to protect the servers on wlp1s0 (to "192.168.0.0/24    "),
	# uncomment the following line.
	# > protection strong

	# To NAT client requests on the output of wlp1s0, add this.
	# > masquerade
	# Alternatively, you can SNAT them by placing this at the top of this config:
	# > snat to 192.168.0.1 outface wlp1s0 src "192.168.2.0/24   " dst "192.168.0.0/24    "
	# SNAT commands can be enhanced using 'proto', 'sport', 'dport', etc in order to
	# NAT only some specific traffic.

	# TODO: This will allow all traffic to pass.
	# If you remove it, no REQUEST will pass matching this traffic.
	route all accept


# Router No 13.
# Clients on enp2s0 (from not "${UNROUTABLE_IPS} 192.168.2.0/24   ") accessing servers on br-02c455c3f376 (to "172.20.0.0/16 ").
# TODO: Change "router13" to something with meaning to you.
# TODO: Check the optional rule parameters (src/dst).
#       To add IPv6, read http://firehol.org/upgrade/#config-version-6
# Router No 14.
# Clients on enp2s0 (from not "${UNROUTABLE_IPS} 192.168.2.0/24   ") accessing servers on squid_interface (to "172.23.0.0/16  ").
# TODO: Change "router14" to something with meaning to you.
# TODO: Check the optional rule parameters (src/dst).
#       To add IPv6, read http://firehol.org/upgrade/#config-version-6
router4 router14 inface enp2s0 outface squid_interface src not "${UNROUTABLE_IPS} 192.168.2.0/24   " dst "172.23.0.0/16  "

	# If you don't trust the clients on enp2s0 (from not "${UNROUTABLE_IPS} 192.168.2.0/24   "), or
	# if you want to protect the servers on squid_interface (to "172.23.0.0/16  "),
	# uncomment the following line.
	# > protection strong

	# To NAT client requests on the output of squid_interface, add this.
	# > masquerade
	# Alternatively, you can SNAT them by placing this at the top of this config:
	# > snat to 172.23.0.1 outface squid_interface src not "${UNROUTABLE_IPS} 192.168.2.0/24   " dst "172.23.0.0/16  "
	# SNAT commands can be enhanced using 'proto', 'sport', 'dport', etc in order to
	# NAT only some specific traffic.

	# TODO: This will allow all traffic to pass.
	# If you remove it, no REQUEST will pass matching this traffic.
	route all accept


# Router No 15.
# Clients on enp2s0 (from not "${UNROUTABLE_IPS} 192.168.2.0/24   ") accessing servers on enp2s0 (to "192.168.2.0/24   ").
# TODO: Change "router15" to something with meaning to you.
# TODO: Check the optional rule parameters (src/dst).
#       To add IPv6, read http://firehol.org/upgrade/#config-version-6
router4 router15 inface enp2s0 outface enp2s0 src not "${UNROUTABLE_IPS}" dst "192.168.2.1"

	# If you don't trust the clients on enp2s0 (from not "${UNROUTABLE_IPS} 192.168.2.0/24   "), or
	# if you want to protect the servers on enp2s0 (to "192.168.2.0/24   "),
	# uncomment the following line.
	# > protection strong

	# To NAT client requests on the output of enp2s0, add this.
	# > masquerade
	# Alternatively, you can SNAT them by placing this at the top of this config:
	# > snat to 192.168.2.185 outface enp2s0 src not "${UNROUTABLE_IPS} 192.168.2.0/24   " dst "192.168.2.0/24   "
	# SNAT commands can be enhanced using 'proto', 'sport', 'dport', etc in order to
	# NAT only some specific traffic.

	# TODO: This will allow all traffic to pass.
	# If you remove it, no REQUEST will pass matching this traffic.
	client all accept
	route all accept


# Router No 16.
# Clients on enp2s0 (from not "${UNROUTABLE_IPS} 192.168.2.0/24   ") accessing servers on wlp1s0 (to "192.168.0.0/24    ").
# TODO: Change "router16" to something with meaning to you.
# TODO: Check the optional rule parameters (src/dst).
#       To add IPv6, read http://firehol.org/upgrade/#config-version-6
router4 router16 inface enp2s0 outface wlp1s0 src not "${UNROUTABLE_IPS} 192.168.2.0/24   " dst "192.168.0.0/24    "

	# If you don't trust the clients on enp2s0 (from not "${UNROUTABLE_IPS} 192.168.2.0/24   "), or
	# if you want to protect the servers on wlp1s0 (to "192.168.0.0/24    "),
	# uncomment the following line.
	# > protection strong

	# To NAT client requests on the output of wlp1s0, add this.
	# > masquerade
	# Alternatively, you can SNAT them by placing this at the top of this config:
	# > snat to 192.168.0.1 outface wlp1s0 src not "${UNROUTABLE_IPS} 192.168.2.0/24   " dst "192.168.0.0/24    "
	# SNAT commands can be enhanced using 'proto', 'sport', 'dport', etc in order to
	# NAT only some specific traffic.

	# TODO: This will allow all traffic to pass.
	# If you remove it, no REQUEST will pass matching this traffic.
	route all accept


# Router No 17.
# Clients on wlp1s0 (from "192.168.0.0/24    ") accessing servers on br-02c455c3f376 (to "172.20.0.0/16 ").
# TODO: Change "router17" to something with meaning to you.
# TODO: Check the optional rule parameters (src/dst).
#       To add IPv6, read http://firehol.org/upgrade/#config-version-6
router4 router17 inface wlp1s0 outface br-02c455c3f376 src "192.168.0.0/24    " dst "172.20.0.0/16 "

	# If you don't trust the clients on wlp1s0 (from "192.168.0.0/24    "), or
	# if you want to protect the servers on br-02c455c3f376 (to "172.20.0.0/16 "),
	# uncomment the following line.
	# > protection strong

	# To NAT client requests on the output of br-02c455c3f376, add this.
	# > masquerade
	# Alternatively, you can SNAT them by placing this at the top of this config:
	# > snat to 172.20.0.1 outface br-02c455c3f376 src "192.168.0.0/24    " dst "172.20.0.0/16 "
	# SNAT commands can be enhanced using 'proto', 'sport', 'dport', etc in order to
	# NAT only some specific traffic.

	# TODO: This will allow all traffic to pass.
	# If you remove it, no REQUEST will pass matching this traffic.
	route all accept


# Router No 18.
# Clients on wlp1s0 (from "192.168.0.0/24    ") accessing servers on squid_interface (to "172.23.0.0/16  ").
# TODO: Change "router18" to something with meaning to you.
# TODO: Check the optional rule parameters (src/dst).
#       To add IPv6, read http://firehol.org/upgrade/#config-version-6
router4 router18 inface wlp1s0 outface squid_interface src "192.168.0.0/24    " dst "172.23.0.0/16  "

	# If you don't trust the clients on wlp1s0 (from "192.168.0.0/24    "), or
	# if you want to protect the servers on squid_interface (to "172.23.0.0/16  "),
	# uncomment the following line.
	# > protection strong

	# To NAT client requests on the output of squid_interface, add this.
	# > masquerade
	# Alternatively, you can SNAT them by placing this at the top of this config:
	# > snat to 172.23.0.1 outface squid_interface src "192.168.0.0/24    " dst "172.23.0.0/16  "
	# SNAT commands can be enhanced using 'proto', 'sport', 'dport', etc in order to
	# NAT only some specific traffic.

	# TODO: This will allow all traffic to pass.
	# If you remove it, no REQUEST will pass matching this traffic.
	route all accept


# Router No 19.
# Clients on wlp1s0 (from "192.168.0.0/24    ") accessing servers on enp2s0 (to "192.168.2.0/24   ").
# TODO: Change "router19" to something with meaning to you.
# TODO: Check the optional rule parameters (src/dst).
#       To add IPv6, read http://firehol.org/upgrade/#config-version-6
router4 router19 inface wlp1s0 outface enp2s0 src "192.168.0.0/24    " dst "192.168.2.0/24   "

	# If you don't trust the clients on wlp1s0 (from "192.168.0.0/24    "), or
	# if you want to protect the servers on enp2s0 (to "192.168.2.0/24   "),
	# uncomment the following line.
	# > protection strong

	# To NAT client requests on the output of enp2s0, add this.
	# > masquerade
	# Alternatively, you can SNAT them by placing this at the top of this config:
	# > snat to 192.168.2.185 outface enp2s0 src "192.168.0.0/24    " dst "192.168.2.0/24   "
	# SNAT commands can be enhanced using 'proto', 'sport', 'dport', etc in order to
	# NAT only some specific traffic.

	# TODO: This will allow all traffic to pass.
	# If you remove it, no REQUEST will pass matching this traffic.
	route all accept


# Router No 20.
# Clients on wlp1s0 (from "192.168.0.0/24    ") accessing servers on enp2s0 (to not "${UNROUTABLE_IPS} 192.168.2.0/24   ").
# TODO: Change "router20" to something with meaning to you.
# TODO: Check the optional rule parameters (src/dst).
#       To add IPv6, read http://firehol.org/upgrade/#config-version-6
router4 router20 inface wlp1s0 outface enp2s0 src "192.168.0.0/24    " dst not "${UNROUTABLE_IPS} 192.168.2.0/24   "

	# If you don't trust the clients on wlp1s0 (from "192.168.0.0/24    "), or
	# if you want to protect the servers on enp2s0 (to not "${UNROUTABLE_IPS} 192.168.2.0/24   "),
	# uncomment the following line.
	# > protection strong

	# To NAT client requests on the output of enp2s0, add this.
	# > masquerade
	# Alternatively, you can SNAT them by placing this at the top of this config:
	# > snat to 192.168.2.185 outface enp2s0 src "192.168.0.0/24    " dst not "${UNROUTABLE_IPS} 192.168.2.0/24   "
	# SNAT commands can be enhanced using 'proto', 'sport', 'dport', etc in order to
	# NAT only some specific traffic.

	# TODO: This will allow all traffic to pass.
	# If you remove it, no REQUEST will pass matching this traffic.
	route all accept
